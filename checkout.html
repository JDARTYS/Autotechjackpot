<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Checkout - AutoTechJackpot</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <div class="header-container">
      <div class="logo">
          <a href="index.html">AutoTechJackpot</a>
      </div>
    <nav>
      <a href="how-it-works.html">How It Works</a>
      <a href="winners.html">Winners</a>
      <a href="tickets.html">Tickets</a>
      <a href="cart.html">Cart</a>
      <a href="login.html">Login / Register</a>
      <a href="activecompetitions.html">Active Competitions</a>
    </nav>
  </header>

  <main>
    <section class="checkout">
      <h1>Checkout</h1>
      <p>Review your order and proceed to payment.</p>

      <!-- Dettagli dell'ordine -->
      <div class="order-summary" id="order-summary">
        <!-- Ordine aggiunto dinamicamente -->
      </div>

      <!-- Sezione di pagamento -->
      <div class="payment-section">
        <!-- Link PayPal.me con importo dinamico -->
        <a id="paypal-button" href="#" class="cta-button">
          Complete Payment via PayPal
        </a>
      </div>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 AutoTechJackpot. All rights reserved.</p>
    <nav>
        <a href="policy.html">Terms & Policy</a> |  
    </nav>
  </footer>

  <script>
    // Funzione per calcolare l'importo totale dal carrello
    function calculateTotal(cart) {
      let total = 0;
      let orderDetails = [];

      cart.forEach(item => {
        total += parseFloat(item.ticketPrice) || 0;
        orderDetails.push(`
          <p>${item.competitionName}: €${item.ticketPrice} x ${item.quantity}</p>
        `);
      });

      return { total: total.toFixed(2), orderDetails };
    }

    document.addEventListener('DOMContentLoaded', () => {
      // Recupera il carrello dal localStorage
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      
      // Debug per controllare il contenuto del carrello
      console.log('Carrello:', cart);

      // Calcola il totale e i dettagli dell'ordine
      const { total, orderDetails } = calculateTotal(cart);

      const orderSummary = document.getElementById('order-summary');
      
      // Verifica se il carrello è vuoto
      if (cart.length > 0) {
        // Mostra i dettagli dell'ordine
        orderSummary.innerHTML = `
          ${orderDetails.join('')}
          <p><strong>Total Amount: €${total}</strong></p>
        `;
      } else {
        // Messaggio se il carrello è vuoto
        orderSummary.innerHTML = '<p>Your cart is empty. Please add items to the cart.</p>';
      }

      // Imposta il link PayPal dinamicamente con l'importo del totale
      const paypalLink = `https://paypal.me/autotechjackpot?amount=${total}`;
      const paypalButton = document.getElementById('paypal-button');
      paypalButton.setAttribute('href', paypalLink);
    });
  </script>
</body>
</html>
