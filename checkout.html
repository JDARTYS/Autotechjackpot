<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Checkout - AutoTechJackpot</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <div class="header-container">
      <div class="logo">
        <a href="index.html">AutoTechJackpot</a>
      </div>
      <nav>
        <a href="how-it-works.html">How It Works</a>
        <a href="winners.html">Winners</a>
        <a href="tickets.html">Tickets</a>
        <a href="cart.html">Cart</a>
        <a href="login.html">Login / Register</a>
        <a href="activecompetitions.html">Active Competitions</a>
      </nav>
    </div>
  </header>

  <main>
    <section class="checkout">
      <h1>Checkout</h1>
      <p>Review your order and proceed to payment.</p>

      <!-- Order Details -->
      <div class="order-summary" id="order-summary">
        <!-- Order items will be dynamically added here -->
      </div>

      <!-- Payment Section -->
      <div class="payment-section">
        <a id="paypal-button" href="#" class="cta-button">Complete Payment via PayPal</a>
      </div>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 AutoTechJackpot. All rights reserved.</p>
    <nav>
      <a href="policy.html">Terms & Policy</a>
    </nav>
  </footer>

  <script>
    // Function to calculate total amount and generate order details
    function calculateTotal(cart) {
      let total = 0;
      let orderDetails = '';

      cart.forEach(item => {
        total += parseFloat(item.ticketPrice) * (item.quantity || 1);
        orderDetails += `
          <div class="order-item">
            <p><strong>${item.competitionName}</strong></p>
            <p>Price: €${parseFloat(item.ticketPrice).toFixed(2)} x ${item.quantity || 1}</p>
          </div>
        `;
      });

      return { total: total.toFixed(2), orderDetails };
    }

    document.addEventListener('DOMContentLoaded', () => {
      // Retrieve the cart from localStorage
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      
      console.log('Cart contents:', cart); // Debug: check the cart data

      const orderSummary = document.getElementById('order-summary');
      const paypalButton = document.getElementById('paypal-button');

      if (cart.length > 0) {
        // Calculate total and details
        const { total, orderDetails } = calculateTotal(cart);

        // Display order details and total
        orderSummary.innerHTML = `
          ${orderDetails}
          <p class="order-total"><strong>Total Amount: €${total}</strong></p>
        `;

        // Update PayPal link with dynamic total
        paypalButton.href = `https://paypal.me/autotechjackpot?amount=${total}`;
      } else {
        // Display message for empty cart
        orderSummary.innerHTML = '<p>Your cart is empty. Please add items to the cart.</p>';
        paypalButton.style.display = 'none'; // Hide PayPal button if cart is empty
      }
    });
  </script>
</body>
</html>
