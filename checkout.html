<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Checkout - AutoTechJackpot</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <div class="header-container">
      <div class="logo">
        <a href="index.html">AutoTechJackpot</a>
      </div>
      <nav>
        <a href="how-it-works.html">How It Works</a>
        <a href="winners.html">Winners</a>
        <a href="tickets.html">Tickets</a>
        <a href="cart.html">Cart</a>
        <a href="login.html">Login / Register</a>
        <a href="activecompetitions.html">Active Competitions</a>
      </nav>
    </div>
  </header>

  <main>
    <section class="checkout">
      <h1>Checkout</h1>
      <p>Review your order and proceed to payment.</p>

      <!-- Order Details -->
      <div class="order-summary" id="order-summary">
        <!-- Order items will be dynamically added here -->
      </div>

      <!-- Payment Section -->
      <div class="payment-section">
        <a id="paypal-button" href="#" class="cta-button">Complete Payment via PayPal</a>
      </div>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 AutoTechJackpot. All rights reserved.</p>
    <nav>
      <a href="policy.html">Terms & Policy</a>
    </nav>
  </footer>
  <script>
  // Funzione per calcolare totale e dettagli ordine
  function calculateTotal(cart) {
    let total = 0;
    let orderDetails = '';

    cart.forEach(item => {
      const price = parseFloat(item.price) || 0; // Usa 'price' invece di 'ticketPrice'
      const quantity = item.quantity || 1; // Default a 1 se non presente

      total += price * quantity;

      orderDetails += `
        <div class="order-item">
          <p><strong>${item.name || "Unnamed Competition"}</strong></p>
          <p>Price: €${price.toFixed(2)} x ${quantity}</p>
        </div>
      `;
    });

    return { total: total.toFixed(2), orderDetails };
  }

  document.addEventListener('DOMContentLoaded', () => {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    console.log('Cart contents:', cart); // Debug per verificare il contenuto

    const orderSummary = document.getElementById('order-summary');
    const paypalButton = document.getElementById('paypal-button');

    if (cart.length > 0) {
      const { total, orderDetails } = calculateTotal(cart);

      orderSummary.innerHTML = `
        ${orderDetails}
        <p class="order-total"><strong>Total Amount: €${total}</strong></p>
      `;

      paypalButton.href = `https://paypal.me/autotechjackpot?amount=${total}`;
    } else {
      orderSummary.innerHTML = '<p>Your cart is empty. Please add items to the cart.</p>';
      paypalButton.style.display = 'none'; // Nascondi pulsante PayPal se il carrello è vuoto
    }
  });
</script>
</body>
</html>
